$(window).on("load",function(){waterfall("main","pin");var a={data:[{src:"1.jpg"},{src:"2.jpg"},{src:"3.jpg"},{src:"4.jpg"}]};window.onscroll=function(){if(checkscrollside()){$.each(a.data,function(c,e){var b=$("<div>").addClass("pin").appendTo($("#main"));var d=$("<div>").addClass("box").appendTo(b);$("<img>").attr("src","./images/"+$(e).attr("src")).appendTo(d)});waterfall()}}});function waterfall(f,d){var a=$("#main>div");var c=a.eq(0).width();var b=Math.floor($(window).width()/c);$("#main").css({"width:":c*b,margin:"0 auto"});var e=[];a.each(function(h,k){var j=a.eq(h).height();if(h<b){e[h]=j}else{var i=Math.min.apply(null,e);var g=$.inArray(i,e);$(k).css({position:"absolute",top:i+15,left:a.eq(g).position().left});e[g]+=a.eq(h).height()+15}})}function checkscrollside(){var a=$("#main>div");var c=a.last().get(0).offsetTop+Math.floor(a.last().height()/2);var d=$(window).scrollTop();var b=$(document).width();return(c<d+b)?true:false};